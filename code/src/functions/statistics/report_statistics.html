{# ============================================================================= #}
{# Statistics Reportt Template                                                   #}
{# For Customer on a defined period and status                                   #}
{# (c) Sertechno 2022                                                            #}
{# GLVH @ 20220412                                                               #}
{# ============================================================================= #}
{% extends "collector_app.html" %}

{% import "bootstrap/wtf.html" as wtf %}

{% import "_macros.html" as macros %}

{% block title %}{{gettext('Statistics Report')}}{% endblock title %}
    
{% block content %}

{% for r in resumes %}
    <h1>{{r.name}}</h1>
    {% set resume=r.resume %}
    <table>
        <tr>
            <td style="width:33%">
                <table class="table table-striped table-hover table-sm" align="center"> 
                    <tr><td>User      </td><td>{{resume.user}}</td></tr>
                    <tr><td>Customer  </td><td>{{resume.customer}}</td></tr>
                    <tr><td>start     </td><td>{{resume.start.strftime("%Y-%m-%d")}}</td></tr>
                    <tr><td>end       </td><td>{{resume.end.strftime("%Y-%m-%d")}}</td></tr>
                    <tr><td>status    </td><td>{{resume.status}}</td></tr>
                    <tr><td>currency  </td><td>{{resume.currency}}</td></tr>
                    <tr><td>platform  </td><td>{{resume.platform}}</td></tr>
                    <tr><td>agregation</td><td>{{resume.agregation}} {{resume.description.split(':')[2]}}</td></tr>
                    {% if resume.agregation not in [1,3,4] %}
                        <tr><td>Quantity at Rate </td><td>{{"{:,.0f}".format(resume.Quantity_at_Rate)}}</td></tr>
                        <tr><td>Quantity         </td><td>{{"{:,.0f}".format(resume.Quantity)}}</td></tr>
                        <tr><td>Total at Currency</td><td>{{"{:,.2f}".format(resume.ST_at_Cur)}}</td></tr>
                        <tr><td>rows      </td><td>{{resume.rows|length}}</td></tr>
                    {% endif %}
                </table>
            </td>
            <td>
                {% if resume.agregation in [1,3,4] %}
                    <table style="width:50%" class="table table-striped table-hover table-sm" align="center"> 
                        <thead>
                                <tr>
                                    <th>CC</th>
                                    <th>Type</th>
                                    <th>Q@R</th>
                                    <th>Quantity</th>
                                    <th>Sub Total</th>
                                    <th>Currency</th>
                                    <th>Count</th>
                                    <th>Platform</th>
                                </tr>
                        </thead>
                        <tbody>
                            {% for row in resume.rows %}
                            <tr>
                                <td>              {{row.CC_Id}}</td>
                                <td>              {{row.Typ_Code}}</td>
                                <td align="right" >{{"{:,.2f}".format(row.CR_Quantity_at_Rate)}}</td> 
                                <td align="right" >{{"{:,.2f}".format(row.CR_Quantity)}}</td>
                                <td align="right" >{{"{:,.2f}".format(row.CR_ST_at_Cur)}}</td>
                                <td align="center">{{row.Cur_Code}}</td>
                                <td align="right" >{{"{:,.0f}".format(row.CIT_Count)}}</td>
                                <td align="center">              {{row.Pla_Id}}</td>
                            </tr>
                            {% endfor %}
                            <tr>
                                <td></td>
                                <td></td>
                                <td align="right"><b>{{"{:,.2f}".format(resume.Quantity_at_Rate)}}</b></td>
                                <td align="right"><b>{{"{:,.2f}".format(resume.Quantity)}}</b></td>
                                <td align="right"><b>{{"{:,.2f}".format(resume.ST_at_Cur)}}</b></td>
                                <td></td>
                                <td align="right"><b>{{"{:,.0f}".format(resume.CIT_Count)}}</b></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                {% endif %}
            </td>
        </tr>
    </table>
{% endfor %}
{% endblock content %}

{# ============================================================================= #}
